<!-- /lib/components/Methodology.svelte -->
<script>
    import { onMount } from 'svelte';
    import { fade } from 'svelte/transition';
    import SectionTransition from './SectionTransition.svelte';
    
    let isInView = false;
    let observers = [];
  
    const methods = [
      {
        id: 'diagnostic',
        icon: 'üéØ',
        title: 'Diagn√≥stico Inicial Personalizado',
        description: 'Evaluamos tu nivel actual en matem√°ticas y f√≠sica para crear un plan de estudio adaptado a tus necesidades espec√≠ficas.',
        features: [
          {
            title: 'Evaluaci√≥n Completa',
            description: 'Test diagn√≥stico que eval√∫a conocimientos previos, habilidades de razonamiento y √°reas de oportunidad.',
            icon: 'üìä'
          },
          {
            title: 'Plan Personalizado',
            description: 'Creaci√≥n de una ruta de aprendizaje √∫nica basada en tus resultados y objetivos.',
            icon: 'üéØ'
          },
          {
            title: 'Objetivos Medibles',
            description: 'Establecimiento de metas espec√≠ficas y puntos de control para tu progreso.',
            icon: 'üìà'
          },
          {
            title: 'Retroalimentaci√≥n Detallada',
            description: 'An√°lisis profundo de tus fortalezas y √°reas de mejora.',
            icon: 'üìã'
          }
        ],
        stats: [
          { value: '98%', label: 'Precisi√≥n en diagn√≥stico' },
          { value: '35%', label: 'Mejora promedio' }
        ]
      },
      {
        id: 'classes',
        icon: 'üë®‚Äçüè´',
        title: 'Clases Estructuradas y Din√°micas',
        description: 'Sistema de 6 horas semanales dise√±ado para maximizar tu comprensi√≥n y retenci√≥n de conceptos clave.',
        features: [
          {
            title: 'Clases Te√≥rico-Pr√°cticas',
            description: '4 horas semanales dedicadas a la explicaci√≥n y aplicaci√≥n de conceptos fundamentales.',
            icon: 'üìö'
          },
          {
            title: 'Sesi√≥n de Dudas',
            description: '2 horas semanales exclusivas para resolver preguntas espec√≠ficas y reforzar conocimientos.',
            icon: '‚ùì'
          },
          {
            title: 'Grupos Reducidos',
            description: 'M√°ximo 20 estudiantes por grupo para garantizar atenci√≥n personalizada.',
            icon: 'üë•'
          },
          {
            title: 'Material Multimedia',
            description: 'Acceso a grabaciones, recursos interactivos y material complementario 24/7.',
            icon: 'üé•'
          }
        ],
        stats: [
          { value: '92%', label: 'Satisfacci√≥n estudiantil' },
          { value: '100%', label: 'Cobertura tem√°tica' }
        ]
      },
      {
        id: 'practice',
        icon: 'üí°',
        title: 'Pr√°ctica Intensiva y Simulacros',
        description: 'Sistema integral de pr√°ctica que combina ejercicios progresivos con simulacros realistas del examen.',
        features: [
          {
            title: 'Banco de Ejercicios',
            description: 'M√°s de 2000 ejercicios clasificados por tema y nivel de dificultad.',
            icon: 'üìù'
          },
          {
            title: 'Simulacros Semanales',
            description: 'Ex√°menes que replican exactamente el formato y nivel del examen real.',
            icon: '‚úçÔ∏è'
          },
          {
            title: 'An√°lisis de Errores',
            description: 'Sistema inteligente que identifica patrones en tus errores y sugiere √°reas de mejora.',
            icon: 'üîç'
          },
          {
            title: 'Retroalimentaci√≥n Inmediata',
            description: 'Explicaciones detalladas y soluciones paso a paso para cada ejercicio.',
            icon: 'üìå'
          }
        ],
        stats: [
          { value: '2000+', label: 'Ejercicios disponibles' },
          { value: '45%', label: 'Mejora en simulacros' }
        ]
      },
      {
        id: 'monitoring',
        icon: 'üìä',
        title: 'Seguimiento Continuo y Ajustes',
        description: 'Sistema de monitoreo en tiempo real que permite ajustar la estrategia seg√∫n tu progreso.',
        features: [
          {
            title: 'Dashboard Personal',
            description: 'Interfaz intuitiva que muestra tu progreso, estad√≠sticas y √°reas de mejora.',
            icon: 'üì±'
          },
          {
            title: 'Alertas Inteligentes',
            description: 'Sistema que identifica y notifica sobre temas que requieren refuerzo.',
            icon: 'üîî'
          },
          {
            title: 'Reportes Semanales',
            description: 'Informes detallados de tu desempe√±o y recomendaciones personalizadas.',
            icon: 'üìä'
          },
          {
            title: 'Ajustes Estrat√©gicos',
            description: 'Modificaciones al plan de estudio basadas en tu desempe√±o real.',
            icon: '‚öôÔ∏è'
          }
        ],
        stats: [
          { value: '24/7', label: 'Monitoreo disponible' },
          { value: '96%', label: 'Efectividad en ajustes' }
        ]
      }
    ];
  
    onMount(() => {
      // Observador para la secci√≥n principal
      const sectionObserver = new IntersectionObserver(
        ([entry]) => {
          if (entry.isIntersecting) {
            isInView = true;
          }
        },
        { threshold: 0.1 }
      );
  
      const section = document.querySelector('.methodology-section');
      if (section) {
        sectionObserver.observe(section);
      }
      observers.push(sectionObserver);
  
      return () => {
        observers.forEach(observer => observer.disconnect());
      };
    });
</script>

<style>
  :root {
    /* Paleta de Colores */
    --color-primary: #1E3A8A; /* Azul Marino */
    --color-secondary: #10B981; /* Verde Esmeralda */
    --color-background: #F9FAFB; /* Blanco Humo */
    --color-text: #111827; /* Casi Negro */
    --color-accent: #F59E0B; /* Amarillo √Åmbar */
    --color-border: #D1D5DB; /* Gris Claro */
    --gradient: linear-gradient(135deg, #1E3A8A 0%, #10B981 100%);
    
    /* Tipograf√≠a */
    --font-family: 'Inter', sans-serif;
    
    /* Transiciones */
    --transition-duration: 0.3s;
    --transition-ease: ease;
  }

  .methodology-section {
    position: relative;
    padding: 8rem 2rem;
    background: var(--color-background);
    color: var(--color-text);
    overflow: hidden;
  }

  .methodology-pattern {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url('/patterns/circuit-board.svg');
    opacity: 0.05; /* Ajustado para una mayor sutilidad */
    z-index: 1;
  }

  .methodology-container {
    max-width: 1400px;
    margin: 0 auto;
    position: relative;
    z-index: 2;
  }

  .methodology-header {
    text-align: center;
    margin-bottom: 4rem;
  }

  .methodology-title {
    font-size: 3rem;
    margin-bottom: 1rem;
    color: var(--color-primary);
  }

  .methodology-description {
    font-size: 1.25rem;
    opacity: 0.95;
    max-width: 800px;
    margin: 0 auto;
    line-height: 1.8;
    color: var(--color-text);
  }

  .methods-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; /* Mantiene 2 columnas */
    gap: 4rem; /* Mantiene el espacio original */
  }

  .method-card {
    background: #FFFFFF; /* Fondo Blanco para las tarjetas */
    border-radius: 1.5rem;
    padding: 2rem;
    transition: all var(--transition-duration) var(--transition-ease);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra ligera */
    border: 1px solid var(--color-border);
  }

  .method-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 15px rgba(0, 0, 0, 0.15);
  }

  .method-header {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 1rem;
  }

  .method-icon {
    font-size: 2.5rem;
    color: var(--color-primary);
  }

  .method-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin: 0;
    color: var(--color-text);
  }

  .method-description {
    font-size: 1.1rem;
    line-height: 1.6;
    opacity: 0.9;
    margin-bottom: 1.5rem;
    color: var(--color-text);
  }

  .features-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr); /* Mantiene 2 columnas */
    gap: 2rem; /* Mantiene el espacio original */
    margin-bottom: 2rem;
  }

  .feature-card {
    background: #FFFFFF; /* Fondo Blanco para las caracter√≠sticas */
    border-radius: 1rem;
    padding: 1.5rem;
    transition: transform var(--transition-duration) var(--transition-ease), background var(--transition-duration) var(--transition-ease);
    border: 1px solid var(--color-border);
  }

  .feature-card:hover {
    background: #1e3a8a;
    transform: translateY(-5px);
    color: #FFFFFF;
  }

  .feature-card:hover .feature-title,
  .feature-card:hover .feature-description {
    color: #FFFFFF;
  }

  .feature-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .feature-icon {
    font-size: 1.5rem;
    color: var(--color-accent);
  }

  .feature-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--color-text);
    margin: 0;
  }

  .feature-description {
    font-size: 0.95rem;
    line-height: 1.5;
    color: var(--color-text);
    opacity: 0.8;
  }

  .stats-container {
    display: flex;
    justify-content: space-around;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--color-border);
    color: var(--color-text);
  }

  .stat-item {
    text-align: center;
  }

  .stat-value {
    font-size: 2rem;
    font-weight: 800;
    color: var(--color-primary);
    margin-bottom: 0.5rem;
  }

  .stat-label {
    font-size: 0.9rem;
    color: var(--color-text);
    opacity: 0.8;
  }

  /* Efectos decorativos */
  .decoration-circle {
    position: absolute;
    border-radius: 50%;
    background: rgba(30, 58, 138, 0.05); /* Azul Marino con baja opacidad */
    animation: float 20s infinite;
  }

  @keyframes float {
    0%, 100% {
      transform: translate(0, 0) rotate(0deg);
    }
    50% {
      transform: translate(-20px, -20px) rotate(180deg);
    }
  }

  @media (max-width: 1024px) {
    .methods-grid {
      grid-template-columns: 1fr;
    }

    .features-grid {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 768px) {
    .methodology-title {
      font-size: 2.5rem;
    }

    .method-card {
      padding: 1.5rem;
    }

    .method-header {
      flex-direction: column;
      text-align: center;
    }

    .stats-container {
      flex-direction: column;
      gap: 1.5rem;
    }
  }
</style>

<section class="methodology-section" id="metodologia">
  <div class="methodology-pattern"></div>
  
  <!-- Elementos decorativos -->
  {#each Array(5) as _, i}
    <div
      class="decoration-circle"
      style="
        width: {Math.random() * 200 + 100}px;
        height: {Math.random() * 200 + 100}px;
        top: {Math.random() * 100}%;
        left: {Math.random() * 100}%;
        animation-delay: -{Math.random() * 10}s;
      "
    ></div>
  {/each}

  <SectionTransition position="top" type="wave" />
  
  <div class="methodology-container">
    {#if isInView}
      <div class="methodology-header" in:fade={{ duration: 1000 }}>
        <h2 class="methodology-title">Metodolog√≠a √önica y Probada</h2>
        <p class="methodology-description">
          Nuestro sistema de ense√±anza est√° dise√±ado cient√≠ficamente para maximizar tu aprendizaje
          y garantizar tu √©xito en el examen de admisi√≥n.
        </p>
      </div>

      <div class="methods-grid">
        {#each methods as method, index}
          <div class="method-card" in:fade={{ duration: 1000, delay: 200 * index }}>
            <div class="method-header">
              <span class="method-icon">{method.icon}</span>
              <h3 class="method-title">{method.title}</h3>
            </div>
            <p class="method-description">{method.description}</p>
            
            <div class="features-grid">
              {#each method.features as feature}
                <div class="feature-card" in:fade={{ duration: 500 }}>
                  <div class="feature-header">
                    <span class="feature-icon">{feature.icon}</span>
                    <h4 class="feature-title">{feature.title}</h4>
                  </div>
                  <p class="feature-description">
                    {feature.description}
                  </p>
                </div>
              {/each}
            </div>

            <div class="stats-container">
              {#each method.stats as stat}
                <div class="stat-item">
                  <div class="stat-value">{stat.value}</div>
                  <div class="stat-label">{stat.label}</div>
                </div>
              {/each}
            </div>
          </div>
        {/each}
      </div>
    {/if}
  </div>

  <SectionTransition position="bottom" type="wave" />
</section>
